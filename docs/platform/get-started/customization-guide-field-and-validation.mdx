---
title: "Field and validation"
description: "Add an author field to products and add a custom validation to it"
---
Add an author field to products and add a custom validation to it

To do this task you first need to complete the task [Author page](/platform/get-started/customization-guide-author-page)

## Add a field to connect books to authors

Your client has to be able to connect books to authors so you need a field to define the link.

To create and connect this field to templates you will use the UI in Litium (but it could also be done in code in `Litium.Accelerator.Definitions.Products.ProductsFieldDefinitionSetup`).

**IMPORTANT!** When you did the [_Author page_ task](/platform/get-started/customization-guide-author-page) earlier you may have modified `DefinitionSetup` so that all templates are re-generated from code on every startup. Since this Author-field is only added in database and not in code it will get removed from the template when the application restarts if automatic re-create is enabled.

1.  Open the Control panel in Litium backoffice and select _Products > Fields_ in left menu
2.  Click _New_ and set:
    1.  _Type_ = **Pointer**
    2.  _Id_ = **AuthorField**
    3.  _Multi language_ = **No**
3.  Save and edit the field, set:
    1.  _Entity_ = **Pages**
    2.  _Name_ = **Author** (for all languages)
4.  Select _Products > Field templates_ in left menu
5.  Make the following adjustment to every field template where _Type_ \= **Product**:
    1.  Select the _Fields_ tab
    2.  Add your new _author_ field to the _General_ fieldgroup

## Try it out

1.  Select _Products_ in top menu and edit a product
2.  Your _Author_ field should now be visible among the fields in the _General_ fieldgroup. If it is not visible make sure that you have the base product selected in the variant drop down, the base product is always the top item in the list.
3.  Edit the property and select the author page you created in the [_Author page_ task](/platform/get-started/customization-guide-author-page) earlier.

## Add validation

During the testing of the _Author_ field it becomes obvious that any page can be set as author for a book. You need to validate that only author pages can be selected.

Additional information on validation is available [in the documentation](https://docs.litium.com/documentation/architecture/validation).

1.  Create the class `ValidateBookAuthor` in namespace `Litium.Accelerator.ValidationRules` that inherit from `Litium.Validations.ValidationRuleBase<BaseProduct>` and implement the `Validate`\-method that the inheritance requires and make it return a new `ValidationResult`
    
2.  Get the selected page-id value of the BaseProduct-entity:
    
    var authorPageId = entity.Fields.GetValue<Guid?>("AuthorField");
    
3.  Inject `Litium.Websites.PageService` and use it to get the author page instance
    
4.  Inject `Litium.FieldFramework.FieldTemplateService` and use it to get the page template
    
    \_fieldTemplateService.Get<FieldTemplate>(authorPage.FieldTemplateSystemId);
    
5.  Verify that the template id is **"Author"**, otherwise call the method `AddError("AuthorField", "Only Author-pages can be selected as author")` on the `ValidationResult` returned from the method.
    
6.  [A finished example can be downloaded here](https://github.com/LitiumAB/Education/blob/99ed050e4241dc15b1f7a5a74f154c880c61cb95/Developer%20Education/Tasks/Validation/Resources/ValidateBookAuthor.cs)
    

## Try it out

1.  Edit a product and try to save it when you have selected a non-author page as author
2.  You should get a validation error preventing you to save

## Optional task: Localize the validation message

In backoffice Litium uses [ASP.NET standard localization](https://docs.microsoft.com/en-us/aspnet/core/fundamentals/localization) with translations kept in resource (.resx) files. More information are available on the [page about translations](https://docs.litium.com/documentation/litium-platform/back-office/translations).

## Add the validation message

The first step is to create a new resource file to keep your project specific translations separated from other translations.

1.  Create a copy of the file `\Src\Litium.Accelerator\Resources\Common.resx` called `Bookstore.resx` in the same folder
    
2.  Delete all strings from `Bookstore.resx` and then add two new ones:
    
    | Name | Value |
    | --- | --- |
    | ValidationProductAuthorField | A page using author template is required |
    | ValidationProductAuthorGlobal | Author page validation failed |
    

## Make your resource file available

In [ASP.NET standard localization](https://docs.microsoft.com/en-us/aspnet/core/fundamentals/localization) a resource file has be named as the class using it, but with Litium we can make all resource files in a project shared with all classes just by setting an assembly attribute. This will also make the strings available to the client Angular UI.

Do the changes below in the file `Litium.Accelerator.csproj`:

1.  Modify the `LitiumLocalization`\-tag to include all resource files in the _Resources_\-folder (not only the _Common_\-file):
    
    <!--Replace:-->
    <LitiumLocalization Include="Resources\\Common\*.resx" />
    <!--With:-->
    <LitiumLocalization Include="Resources\\\*.resx" />
    
2.  Add the assembly attribute below to instruct Litium to include all resource file strings defined by the `LitiumLocalization`\-tag when creating a `IStringLocalizer` for any class in the current project:
    
    <ItemGroup>
        <AssemblyAttribute Include="Litium.Localization.UseAdministrationResourceAttribute" />
    </ItemGroup>
    

## Read the resources in your validation class

1.  Inject `IStringLocalizer<ValidateBookAuthor>` in the constructor of your `ValidateBookAuthor`\-class.
    
2.  Use the injected localizer to get and use the translated errors
    
    result.AddError("AuthorField", \_stringLocalizer\["ValidationProductAuthorField"\]);
    result.AddError("\*", \_stringLocalizer\["ValidationProductAuthorGlobal"\]);
    
3.  Set an invalid author page and verify that the message displayed comes from your resource file.
    

## Add another language

1.  Create a copy of the file `Bookstore.resx` called `Bookstore.sv-se.resx` and translate the texts in the new file to Swedish.
    
2.  Click your username in the top-right corner in backoffice UI to change language to Swedish, then reload the page.
    
3.  Verify that the Swedish error message is now showing for the validation error.
    

## Troubleshooting localization

If your translations are not read from the resource files, check your `.csproj`\-file, if Visual Studio has generated any of the lines below, delete them:

<LitiumLocalization Remove="Resources\\Bookstore.resx" />
<LitiumLocalization Remove="Resources\\Bookstore.sv-se.resx" />

## Next step

[Add a data service to get actual book-products for an author based on the author-field](/platform/get-started/customization-guide-data-service)
