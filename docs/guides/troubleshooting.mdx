---
title: Troubleshooting
description: 'Common issues and solutions for the Litium Admin MCP Server'
---

## Common Issues

This guide helps you resolve common issues when using the Litium Admin MCP Server.

## Connection Issues

### Server Not Responding

<AccordionGroup>
  <Accordion title="Check server is running">
    **Problem**: Server isn't accessible
    
    **Solution**:
    ```bash
    # Test with curl
    curl -I https://your-server.vercel.app/api/mcp
    ```
    
    Should return HTTP 200
  </Accordion>

  <Accordion title="Verify correct URL">
    **Problem**: Wrong URL in configuration
    
    **Solution**: Ensure you're using the correct endpoint:
    - Local: `http://localhost:3000/api/mcp`
    - Vercel: `https://your-project.vercel.app/api/mcp`
    
    Note: `/api/mcp` is required, not just `/api` or `/mcp`
  </Accordion>

  <Accordion title="Check network connectivity">
    **Problem**: Network or firewall blocking access
    
    **Solution**:
    - Test from different network
    - Check firewall settings
    - Verify VPN isn't blocking access
  </Accordion>
</AccordionGroup>

## Authentication Issues

### Invalid Credentials Error

<AccordionGroup>
  <Accordion title="Verify OAuth2 credentials">
    **Problem**: Wrong Client ID or Secret
    
    **Solution**:
    1. Check credentials in Litium admin panel
    2. Ensure no extra spaces or characters
    3. Verify credentials are for correct Litium instance
    
    Test directly:
    ```bash
    curl -X POST https://your-instance.com/Litium/OAuth/token \
      -H "Content-Type: application/x-www-form-urlencoded" \
      -d "grant_type=client_credentials" \
      -d "client_id=your-client-id" \
      -d "client_secret=your-client-secret" \
      -d "scope=admin"
    ```
  </Accordion>

  <Accordion title="Check base URL">
    **Problem**: Wrong Litium instance URL
    
    **Solution**: Verify `X-Litium-Base-Url` header:
    - Should not include `/api` or trailing slash
    - Example: `https://demoadmin.litium.com` ✅
    - Not: `https://demoadmin.litium.com/` ❌
    - Not: `https://demoadmin.litium.com/Litium/api` ❌
  </Accordion>

  <Accordion title="Missing headers">
    **Problem**: Required headers not sent
    
    **Solution**: Ensure all three headers are present:
    - `X-Litium-Base-Url`
    - `X-Litium-Client-Id`
    - `X-Litium-Client-Secret`
  </Accordion>
</AccordionGroup>

### Unauthorized (401) Error

<AccordionGroup>
  <Accordion title="Token expired">
    **Problem**: OAuth2 token has expired
    
    **Solution**: The server should auto-refresh tokens. If issue persists:
    1. Restart your MCP client
    2. Verify credentials are still valid in Litium
    3. Check Litium admin for credential expiration
  </Accordion>

  <Accordion title="Insufficient permissions">
    **Problem**: OAuth2 app doesn't have required scopes
    
    **Solution**: In Litium admin:
    1. Check OAuth2 application settings
    2. Ensure "admin" scope is granted
    3. Verify application is enabled
  </Accordion>
</AccordionGroup>

## API Errors

### Method Not Allowed (405) Error

<AccordionGroup>
  <Accordion title="Search endpoints returning 405">
    **Problem**: Getting 405 error when searching customers, orders, or other entities
    
    **Error Example**:
    ```json
    {
      "statusCode": 405,
      "name": "AuthenticationError"
    }
    ```
    
    **Solution**: This was fixed in version 1.0.1. The Litium API uses POST requests for search endpoints, not GET requests. 
    
    Update to the latest version:
    ```bash
    npm update litium-admin-mcp-server
    ```
    
    **Technical Details**: 
    - Search endpoints (e.g., `/api/admin/customers/people/search`) expect POST with JSON body
    - Earlier versions incorrectly used GET with query parameters
    - Fixed endpoints include: customers, customer groups, organizations, campaigns, discounts, and media files
  </Accordion>

  <Accordion title="Custom search implementation">
    **Problem**: Building custom search queries
    
    **Solution**: Use POST method with this structure:
    ```typescript
    {
      search: "search term",
      skip: 0,
      take: 20,
      sort: "field:asc"
    }
    ```
    
    Not as query parameters in a GET request.
  </Accordion>
</AccordionGroup>

## MCP Client Issues

### Cursor Not Detecting Server

<AccordionGroup>
  <Accordion title="Configuration file location">
    **Problem**: Wrong config file path
    
    **Solution**: Config should be at:
    ```
    .cursor/mcp.json
    ```
    
    Not `.cursor.json` or `cursor/mcp.json`
  </Accordion>

  <Accordion title="Invalid JSON">
    **Problem**: Syntax error in configuration
    
    **Solution**: Validate JSON:
    ```bash
    cat .cursor/mcp.json | jq
    ```
    
    If errors, fix JSON syntax
  </Accordion>

  <Accordion title="Restart required">
    **Problem**: Configuration not loaded
    
    **Solution**: Restart Cursor after configuration changes
  </Accordion>
</AccordionGroup>

### Claude Desktop Not Working

<AccordionGroup>
  <Accordion title="Check mcp-remote installation">
    **Problem**: mcp-remote not available
    
    **Solution**:
    ```bash
    npx -y mcp-remote --version
    ```
    
    Should download and run successfully
  </Accordion>

  <Accordion title="Environment variables">
    **Problem**: Headers not passed correctly
    
    **Solution**: Verify environment variable format:
    ```json
    "env": {
      "MCP_HEADER_X_LITIUM_BASE_URL": "value",
      "MCP_HEADER_X_LITIUM_CLIENT_ID": "value",
      "MCP_HEADER_X_LITIUM_CLIENT_SECRET": "value"
    }
    ```
    
    Note: Underscores in header names, not hyphens!
  </Accordion>

  <Accordion title="Check logs">
    **Problem**: Unknown error
    
    **Solution**: Check Claude Desktop logs:
    ```bash
    # macOS
    tail -f ~/Library/Logs/Claude/mcp*.log
    
    # Windows
    Get-Content "$env:APPDATA\Claude\logs\mcp-*.log" -Wait
    ```
  </Accordion>
</AccordionGroup>

## Tool Execution Issues

### Tool Not Found

<AccordionGroup>
  <Accordion title="Wrong tool name">
    **Problem**: Typo in tool name
    
    **Solution**: List available tools:
    ```bash
    curl -X POST https://your-server.vercel.app/api/mcp \
      -H "Content-Type: application/json" \
      -H "X-Litium-Base-Url: ..." \
      -H "X-Litium-Client-Id: ..." \
      -H "X-Litium-Client-Secret: ..." \
      -d '{"jsonrpc":"2.0","method":"tools/list","id":1}'
    ```
    
    Use exact tool name from the list
  </Accordion>
</AccordionGroup>

### Missing Required Parameters

<AccordionGroup>
  <Accordion title="Check parameter requirements">
    **Problem**: Required parameter not provided
    
    **Solution**: Review tool documentation:
    - [Blocks Tools](/tools/blocks/search-blocks)
    - [Products Tools](/tools/products/search-products)
    - [Customers Tools](/tools/customers/search-customers)
    
    Example error:
    ```json
    {
      "error": "Missing required parameter: systemId"
    }
    ```
  </Accordion>
</AccordionGroup>

### Resource Not Found (404)

<AccordionGroup>
  <Accordion title="Invalid system ID">
    **Problem**: Resource with given ID doesn't exist
    
    **Solution**:
    1. Use search tools to find valid IDs
    2. Verify you're using systemId, not name
    3. Check for typos in the ID
  </Accordion>
</AccordionGroup>

## Performance Issues

### Slow Response Times

<AccordionGroup>
  <Accordion title="Cold start delay">
    **Problem**: First request is slow on Vercel
    
    **Solution**: This is normal for serverless functions
    - First request: 1-3 seconds
    - Subsequent requests: < 500ms
    - Consider Vercel Pro for faster cold starts
  </Accordion>

  <Accordion title="Large result sets">
    **Problem**: Searching returns too much data
    
    **Solution**: Use pagination:
    ```json
    {
      "search": "keyword",
      "take": 20,    // Limit results
      "skip": 0      // Offset for pages
    }
    ```
  </Accordion>

  <Accordion title="Network latency">
    **Problem**: Slow network connection
    
    **Solution**:
    - Test from different location
    - Deploy server closer to your location
    - Check Litium instance response time
  </Accordion>
</AccordionGroup>

## Deployment Issues

### Build Failures

<AccordionGroup>
  <Accordion title="Missing dependencies">
    **Problem**: `npm install` fails
    
    **Solution**:
    ```bash
    # Clear cache
    npm cache clean --force
    
    # Remove and reinstall
    rm -rf node_modules package-lock.json
    npm install
    ```
  </Accordion>

  <Accordion title="TypeScript errors">
    **Problem**: Build fails with TS errors
    
    **Solution**:
    ```bash
    # Check TypeScript
    npm run lint
    
    # Build locally first
    npm run build
    ```
  </Accordion>
</AccordionGroup>

### CORS Errors

<AccordionGroup>
  <Accordion title="Missing CORS headers">
    **Problem**: Cross-origin requests blocked
    
    **Solution**: Verify `vercel.json` includes:
    ```json
    {
      "headers": [
        {
          "source": "/api/mcp",
          "headers": [
            {
              "key": "Access-Control-Allow-Origin",
              "value": "*"
            },
            {
              "key": "Access-Control-Allow-Headers",
              "value": "Content-Type, X-Litium-Base-Url, X-Litium-Client-Id, X-Litium-Client-Secret"
            }
          ]
        }
      ]
    }
    ```
  </Accordion>
</AccordionGroup>

## Error Messages

### Common Error Codes

| Error Code | Meaning | Solution |
|------------|---------|----------|
| 400 | Bad Request | Check request format and parameters |
| 401 | Unauthorized | Verify OAuth2 credentials |
| 403 | Forbidden | Check API permissions/scopes |
| 404 | Not Found | Verify resource ID and endpoint URL |
| 429 | Too Many Requests | Implement rate limiting/backoff |
| 500 | Server Error | Check server logs, may be Litium API issue |

## Getting Help

If you're still experiencing issues:

<CardGroup cols={2}>
  <Card title="GitHub Issues" icon="github" href="https://github.com/tonnguyen/litium-admin-mcp-server/issues">
    Report bugs or ask questions
  </Card>
  <Card title="Litium Documentation" icon="book" href="https://docs.litium.com">
    Official Litium API documentation
  </Card>
  <Card title="MCP Specification" icon="file-code" href="https://modelcontextprotocol.io">
    Learn about Model Context Protocol
  </Card>
  <Card title="Testing Guide" icon="flask" href="/guides/testing">
    Test your setup systematically
  </Card>
</CardGroup>

## Debug Mode

Enable verbose logging for troubleshooting:

```bash
# Local development
DEBUG=* npm run dev

# Check detailed logs
```

## Support Checklist

When reporting issues, include:

<Check>Server URL and version</Check>
<Check>MCP client (Cursor/Claude Desktop) version</Check>
<Check>Full error message</Check>
<Check>Request/response (sanitize credentials!)</Check>
<Check>Steps to reproduce</Check>
<Check>Expected vs actual behavior</Check>

